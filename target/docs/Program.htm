<!DOCTYPE HTML>
<html lang="pt-BR">
<head>
<title>Usando o Programa | AutoHotkey</title>
<meta name="description" content="Aprenda detalhes sobre criação, edição e execução de um script, o ícone da bandeja, a janela principal, uso da linha de comando, portabilidade e opções do instalador." />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="static/theme.css" rel="stylesheet" type="text/css" />
<script src="static/content.js" type="text/javascript"></script>
</head>
<body>
<h1>Usando o Programa</h1>
<p>o AutoHotkey não faz nada por si só; ele precisa de um script para dizer-lhe o que fazer. Um script é simplesmente um arquivo de texto plano, com a extensão <code>.ahk</code> no nome do arquivo, contendo instruções para o programa, como um arquivo de configuração, mas muito mais poderoso. Um script pode fazer algo pequeno como executar uma ação simples e depois finalizar, mas a maioria dos scripts define um certo número de <a href="Hotkeys.htm">teclas de atalho</a> (hotkeys, daqui para frente), com cada uma delas seguida de uma ou mais ações para executar quando a hotkey é pressionada.</p>
<pre>#z::Run https://www.autohotkey.com  <em>; Win+Z</em>

^!n::  <em>; Ctrl+Alt+N</em>
if WinExist("Sem título - Notepad")
    WinActivate
else
    Run Notepad
return</pre>
<p><strong>Dica:</strong> se seu navegador suporta, você pode fazer o download de qualquer bloco de código (como o acima) como um arquivo de script clicando-se no botão que aparece no canto superior direito do  retângulo quando você passa o cursor do mouse sobre.</p>

<h2 id="toc">Sumário</h2>
<ul>
  <li><a href="#create">Criar um script</a></li>
  <li><a href="#edit">Editar um script</a></li>
  <li><a href="#run">Executar um script</a></li>
  <li><a href="#tray-icon">Ícone da bandeja</a></li>
  <li><a href="#main-window">Janela principal</a></li>
  <li><a href="#embedded-scripts">Scripts incorporados</a></li>
  <li><a href="#cmd">Uso da Linha de Comando</a></li>
  <li><a href="#portability">Portabilidade do AutoHotkey.exe</a></li>
  <li><a href="#install">Opções do instalador</a>
  <ul>
    <li><a href="#Installer_uiAccess">Executar com acesso de IU</a></li>
  </ul></li>
</ul>

<h2 id="create">Criar um script</h2>
<p>Há alguns jeitos comuns de se criar um arquivo de script:</p>
<ul>
  <li>No Bloco de Notas (ou um <a href="lib/Edit.htm#Editors">editor de texto</a> de sua escolha), salve um arquivo com a extensão <code>.ahk</code>. Em alguns sistemas você pode precisar envolver o nome em aspas para garantir que o editor não adicione outra extensão (como .txt).
  <p class="note">Certifique-se de salvar o arquivo como UTF-8 com BOM se ele conterá caracteres que não sejam ASCII. Para detalhes, veja o <a href="FAQ.htm#nonascii">FAQ</a>.</p></li>
  <li>No Explorador de Arquivos, clique com o botão direito num espaço vazio da pasta onde você quer salvar o script, selecione <strong>Novo</strong> e <strong>AutoHotkey Script</strong>. Você pode então digitar um nome para o script (cuidando para não apagar a extensão <code>.ahk</code> se ela estiver visível).</li>
</ul>
<p class="note">Veja <a href="Language.htm">Linguagem de Confecção de Scripts</a> para detalhes de como escrever um script.</p>

<h2 id="edit">Editar um script</h2>
<p>Para abrir um script para edição, clique com o botão direito no arquivo e selecione <strong>Edit Script</strong>. Se o script já estiver em execução, você pode usar o comando <a href="lib/Edit.htm">Edit</a> ou clique com o botão direito em seu <a href="#tray-icon">ícone da bandeja</a> e selecionar <strong>Edit This Script</strong>. Por padrão isso abrirá o Bloco de Notas, mas você pode mudar o editor de texto inserindo mudanças no registro como mostrado <a href="lib/Edit.htm#Example">aqui</a>. Evidentemente, você sempre pode abrir seu editor de texto primeiro e aí abrir o script como você faria com qualquer outro arquivo de texto.</p>
<p>Depois de editar um script, você deve carregar ou <a href="lib/Reload.htm">recarregar</a> o script para que as mudanças tenham efeito. Um script em execução normalmente pode ser recarregado por meio do <a href="#tray-icon">menu da bandeja</a>.</p>

<h2 id="run">Executar um script</h2>
<p>Com o AutoHotkey instalado, há várias formas de executar um script:</p>
<ul>
<li>Dê um clique duplo num arquivo de script (ou atalho para um arquivo de script) no Explorador de Arquivos.</li>
<li>Execute AutoHotkey.exe na linha de comando e passe o nome do arquivo do script como um <a href="Scripts.htm#cmd">parâmetro da linha de comando</a>.</li>
<li>Depois de criar <a href="Scripts.htm#defaultfile">o script padrão</a>, execute o AutoHotkey por meio do atalho no Menu Iniciar para abri-lo.</li>
<li>Se o AutoHotkey estiver fixo na barra de tarefas ou no Menu Iniciar do Windows 7 e posteriores, scripts recentes ou fixados podem ser executados pela ***lista suspensa*** do programa.</li>
</ul>
<p>A maioria dos scripts tem efeito somente enquanto estiverem em execução. Use o <a href="#tray-icon">menu da bandeja</a>ou o comando <a href="lib/ExitApp.htm">ExitApp</a> para finalizar um script. Scripts também são forçados a fechar quando o Windows é desligado. Para configurar um script para iniciar automaticamente depois de o usuário fazer login, o jeito mais fácil é colocar um atalho para o arquivo do script na pasta <a href="Variables.htm#Startup">Inicializar</a>.</p>
<p>Scripts também podem ser <a href="Scripts.htm#ahk2exe">compilados</a>; isto é, combinados com um arquivo binário do AutoHotkey para formar um arquivo executável independente (.exe).</p>

<h2 id="tray-icon">Ícone da bandeja</h2>
<p>Por padrão, cada script adiciona seu próprio ícone à área de notificação da barra de tarefas (comumente chamada de “bandeja”).</p>
<p>O ícone da bandeja normalmente é este (mas a cor e as letras mudam conforme o script é <a href="lib/Pause.htm">pausado</a> ou <a href="lib/Suspend.htm">suspenso</a>): <img src="static/ahk16.png" alt="H"></p>
<p>Clique com o botão direito no ícone da bandeja para exibir o menu, que tem as opções seguintes por padrão:</p>
<ul>
<li>Open - Abre a <a href="#main-window">janela principal</a> do script.</li>
<li>Help - Abre o arquivo de ajuda offline do AutoHotkey.</li>
<li>Window Spy - Exibe várias informações sobre uma janela.</li>
<li>Reload This Script - Veja <a href="lib/Reload.htm">Reload</a> (recarregar).</li>
<li>Edit This Script - Veja <a href="lib/Edit.htm">Edit</a> (editar).</li>
<li>Suspend Hotkeys - <a href="lib/Suspend.htm">Suspend</a>e ou reabilita as hotkeys.</li>
<li>Pause Script - <a href="lib/Pause.htm">Pausa</a> ou despausa o script.</li>
<li>Exit - Finaliza o script.</li>
</ul>
<p>Por padrão, clicar com o botão direito no ícone da bandeja mostra a <a href="#main-window">janela principal</a> do script.</p>
<p>O comando <a href="lib/Menu.htm">Menu</a> pode ser usado para personalizar o ícone da bandeja e o menu relacionado.</p>
<p>A diretiva <a href="lib/_NoTrayIcon.htm">#NoTrayIcon</a> pode ser usada para ocultar o ícone da bandeja.</p>

<h2 id="main-window">Janela principal</h2>
<p>A janela principal do script é normalmente oculta, mas pode ser exibida por meio do <a href="#tray-icon">ícone da bandeja</a> ou um dos comandos listados abaixo para obter-se acesso a informações úteis para depurar o script. itens sob o menu <strong>View</strong> controlam o que a janela principal exibe:</p>
<ul>
<li>Linhas executadas mais recentemente - Veja <a href="lib/ListLines.htm">ListLines</a>.</li>
<li>Variáveis e seus conteúdos - Veja <a href="lib/ListVars.htm">ListVars</a>.</li>
<li>Hotkeys e seus métodos - Veja <a href="lib/ListHotkeys.htm">ListHotkeys</a>.</li>
<li>Histórico de teclas e informações do script - Veja <a href="lib/KeyHistory.htm">KeyHistory</a>.</li>
</ul>
<p><strong>Problema conhecido:</strong> atalhos de teclado para itens de menu não funcionam enquanto o script estiver exibindo uma <a href="lib/MsgBox.htm">caixa de mensagem</a> ou outro diálogo.</p>
<p>A variável nativa <a href="Variables.htm#ScriptHwnd">A_ScriptHwnd</a> contém o ID único (HWND) da janela principal do script.</p>
<p>Fechar esta janela com <a href="lib/WinClose.htm">WinClose</a> (mesmo a partir de outro script) causa que o script seja finalizado, mas a maioria dos outros métodos apenas ocultam a janela e deixam o script rodando.</p>
<p>Minimizar a janela principal faz com que ela seja automaticamente oculta. Isso é feito para prevenir que quaisquer janelas criadas pelo script (como janelas de GUI ou certas janelas de diálogo) sejam automaticamente minimizadas, mas também tem o efeito de ocultar o botão da janela principal da barra de tarefas. Para, em vez disso, fazer com que a janela seja minimizada normalmente, use <a href="lib/OnMessage.htm">OnMessage</a> para sobrescrever a forma padrão de manipulação de janelas. Por exemplo:</p>
<pre>; Isto impede a janela principal de ser oculta ou minimizar:
OnMessage(0x0112, Func("PreventAutoMinimize")) <em>; WM_SYSCOMMAND = 0x0112</em>
OnMessage(0x0005, Func("PreventAutoMinimize")) <em>; WM_SIZE = 0x0005
; Isto impede janelas de GUIs (mas não janelas de diálogo) de automaticamente minimizarem:</em>
OnMessage(0x0018, Func("PreventAutoMinimize"))

PreventAutoMinimize(wParam, lParam, uMsg, hwnd) {
    if (uMsg = 0x0112 &amp;&amp; wParam = 0xF020 &amp;&amp; hwnd = A_ScriptHwnd) { <em>; SC_MINIMIZE = 0xF020</em>
        WinMinimize
        return 0 <em>; Impede a janela principal de ser ocultada.</em>
    }
    if (uMsg = 0x0005 &amp;&amp; wParam = 1 &amp;&amp; hwnd = A_ScriptHwnd) <em>; SIZE_MINIMIZED = 1</em>
        return 0 <em>; Impede a janela principal de ser ocultada.</em>
    if (uMsg = 0x0018 &amp;&amp; lParam = 1) <em>; SW_PARENTCLOSING = 1</em>
        return 0 <em>; Impede a minimização de uma janela criada pelo script.</em>
}</pre>

<h3 id="title">Main Window Title</h3>
<p>O  título da janela principal do script é usado pelos mecanismos <a href="lib/_SingleInstance.htm">#SingleInstance</a> e <a href="lib/Reload.htm">Reload</a> para identificar outras instâncias do mesmo script. <a href="lib/WinSetTitle.htm">Alterar o título</a> impede que o script seja identificado como tal. O título padrão depende de como o script foi carregado:</p>
<table class="info">
  <tr><th>Carregado a partir de</th><th>Expressão do Título</th><th>Example</th></tr>
  <tr><td>.ahk file</td><td><code>A_ScriptFullPath " - AutoHotkey v" A_AhkVersion</code></td><td>E:\Meu Script.ahk - AutoHotkey v1.1.33.09</td></tr>
  <tr><td>Recurso principal (script compilado)</td><td><code>A_ScriptFullPath</code></td><td>E:\Meu Script.exe</td></tr>
  <tr><td>Qualquer outra fonte</td><td><code>A_ScriptFullPath " - " A_LineFile</code></td><td>E:\Meu AutoHotkey.exe - *FERRAMENTA-NATIVA.AHK</td></tr>
</table>
<p>O código a seguir ilustra como o título principal pod ser determinado pelo próprio script (mas o título verdadeiro pode ser obtido com o comando <a href="lib/WinGetTitle.htm">WinGetTitle</a>:</p>
<pre>
title := A_ScriptFullPath
if !A_IsCompiled
    title .= " - AutoHotkey v" A_AhkVersion
<em>; Para o resultado correto, este precisa ser determinado pelo recurso que estiver em execução,
; não um #include (a não ser que o #include tenha sido mesclado ao script pelo Ahk2Exe):</em>
else if SubStr(A_LineFile, 1, 1) = "*" &amp;&amp; A_LineFile != "*#1"
    title .= " - " A_LineFile
</pre>

<h2 id="embedded-scripts">Scripts Incorporados <span class="ver">[v1.1.34+]</span></h2>
<p>Scripts may be embedded into a standard AutoHotkey .exe file by adding them as Win32 (RCDATA) resources using the <a href="Scripts.htm#ahk2exe">Ahk2Exe compiler</a>. To add additional scripts, see the <a href="misc/Ahk2ExeDirectives.htm#AddResource">AddResource</a> compiler directive.</p>
<p>Um script incorporado pode ser especificado na linha de comando ou com <a href="lib/_Include.htm">#Include</a> inserindo-se um asterisco (*) seguido do nome do recurso. Para o ID de um número inteiro, o nome do recurso deve ser uma cerquilha (#) seguida de um número decimal.</p>
<p>O problema pode automaticamente carregar o código do script a partir dos recursos abaixo, se estiverem presentes no arquivo:</p>
<table class="info">
  <tr><th>ID</th><th>Spec</th><th>Usage</th></tr>
  <tr>
    <td>1</td><td>*#1</td>
    <td>Esse é o modo pelo qual um <a href="Scripts.htm#ahk2exe">script compilado</a> é criado a partir de um arquivo .exe. Esse script é executado automaticamente e a maioria das opções da linha de comando são passadas ao script em vez de serem interpretadas pelo programa. Scripts externos e scripts alternativos incorporados podem ser executados usando-se o switch <a href="Scripts.htm#SlashScript">/script</a>.</td>
  </tr>
  <tr>
    <td>2</td><td>*#2</td>
    <td>Se presente, esse script é automaticamente “incluído” antes de qualquer script que o programa carrega, e antes de qualquer arquivo especificado com <a href="Scripts.htm#SlashInclude">/include</a>.</td>
  </tr>
</table>
<p>Quando a fonte do script principal é um recurso incorporado, o programa age em “modo de script compilado”, com a exceção de que <a href="Variables.htm#AhkPath">A_AhkPath</a> sempre contém o caminho do arquivo executável atual (o mesmo que <a href="Variables.htm#ScriptFullPath">A_ScriptFullPath</a>). Para recursos além de *#1, o especificador do recurso é incluído no <a href="#title">título da janela principal</a> para suportar <a href="lib/_SingleInstance.htm">#SingleInstance</a> e <a href="lib/Reload.htm">Reload</a>.</p>
<p>Quando referenciado por código que veio de um recurso incorporado, a variável <a href="Variables.htm#LineFile">A_LineFile</a> contém um asterisco (*) seguido do nome do recurso.</p>

<h2 id="cmd">Uso da Linha de Comando</h2>
<p>Veja <a href="Scripts.htm#cmd">Passando Parâmetros da Linha de Comando para um Script</a> para referência sobre o uso da linha de comando, inclusive uma lista de switches que afetam o comportamento do programa.</p>

<h2 id="portability">Portabilidade do AutoHotkey.exe</h2>
<p>O arquivo AutoHotkey.exe é tudo que precisa para executar qualquer script .ahk.</p>
<p><span class="ver">[AHK_L 51+]:</span> renomear AutoHotkey também faz mudar qual script o executável roda <a href="Scripts.htm#defaultfile">por padrão</a>, o que pode ser uma alternativa à compilação do script para usar num computador sem o AutoHotkey instalado. Por exemplo, <i>MeuScript</i>.exe automaticamente executa <i>MeuScript</i>.ahk se um nome de arquivo não for fornecido, mas também é capaz de rodar outros scripts.</p>

<h2 id="install">Opções do instalador</h2>
<p>Para instalar silenciosamente o AutoHotkey no diretório padrão (o qual é o mesmo diretório exibido pelo modo não silencioso), passe o parâmetro /S ao instalador. Por exemplo:</p>
<pre class="no-highlight">AutoHotkey_1.1.34.03_setup.exe /S</pre>
<p>Um diretório que não seja o padrão pode ser especificado pelo parâmetro /D (na ausência de /S, essa opção muda o diretório padrão exibido pelo instalador). Por exemplo:</p>
<pre class="no-highlight">AutoHotkey_1.1.34.03_setup.exe /S /D=C:\Program Files\AutoHotkey</pre>
<p><strong>Versão</strong>: Se o AutoHotkey foi previamente instalado, o instalador automaticamente detecta que versão do AutoHotkey.exe deverá ser definida como a padrão. Do contrário, a versão padrão é a Unicode 32 bits ou Unicode 64 bits, dependendo de o sistema operacional ser ou não 64 bits. Para ignorar qual versão do executável AutoHotkey.exe é definida como a padrão, passe um dos switches a seguir:</p>
<ul>
  <li><code>/A32</code> ou <code>/ANSI</code>: ANSI 32 bits</li>
  <li><code>/U64</code> ou <code>/x64</code>: Unicode 64 bits (só válida em sistemas de 64 bits).</li>
  <li><code>/U32</code>: Unicode 32 bits.</li>
</ul>
<p>POR EXEMPLO, o comando a seguir instala silenciosamente e define a versão ANSI 32 bits como a padrão.</p>
<pre class="no-highlight">AutoHotkey_1.1.34.03_setup.exe /S /A32</pre>
<p><strong>Desinstalação</strong>: Para desintalar silenciosamente o AutoHotkey, passe o parâmetro <code>/Uninstall</code> ao Installer.ahk. Por exemplo:</p>
<pre class="no-highlight">"C:\Program Files\AutoHotkey\AutoHotkey.exe" "C:\Program Files\AutoHotkey\Installer.ahk" /Uninstall</pre>
<p>Para versos do AutoHotkey anteriores à 1.1.08.00, use <code>uninst.exe /S</code>. Por exemplo:</p>
<pre class="no-highlight">"C:\Program Files\AutoHotkey\uninst.exe" /S</pre>
<p><strong>Observação:</strong>o script Installer.ahk deve ser executado como administrador para funcionar corretamente.</p>
<p><strong>Extract</strong> <span class="ver">[v1.1.09.04+]</span>: A link is present in the bottom-right corner of the installer GUI to extract files without installing, and the <code>/E</code> switch can be used to invoke it from the command line. Por exemplo:</p>
<pre class="no-highlight">AutoHotkey_1.1.34.03_setup.exe /D=F:\AutoHotkey /E</pre>
<p><strong>Reiniciar scripts</strong> <span class="ver">[v1.1.19.02+]</span>: No modo de instalação/desinstalação silenciosa, os scripts que estiverem em execução são fechados automaticamente, quando necessário. Passe o switch <code>/R</code> para automaticamente recarregar esses scripts usando qualquer que seja o EXE que os estava executando, <strong>sem</strong> argumentos da linha de comando. A instalação vai tentar executar os scripts via Explorer, então eles não serão executados como administrador se o UAC estiver ativo.</p>

<p id="Installer_IsHostApp"><strong>Botões da barra de tarefas</strong> <span class="ver">[v1.1.08+]</span>: No Windows 7 e posteriores, os botões da barra de tarefas para múltiplos scripts são automaticamente agrupados ou combinados em um único botão, por padrão. A opção <em>Botões separados na barra de tarefas</em> desabilita isso registrando cada executável do AutoHotkey como um <a href="https://msdn.microsoft.com/en-us/library/ee872121#APPLICATIONS">aplicativo hospedeiro (IsHostApp)</a>.</p>
<p><span class="ver">[v1.1.24.02+]:</span> para instalações via linha de comando, especifique as opções <code>/IsHostApp</code> ou <code>/IsHostApp=1</code> para habilitar a opção e <code>/IsHostApp=0</code> para desabilitá-la.</p>

<h3 id="Installer_uiAccess">Executar com acesso de IU <span class="ver">[v1.1.24.02+]</span></h3>
<p>A interface gráfica (GUI) do instalador tem a opção “Add 'Run with UI Access' to context menus”. Essa opção de menu contextual provê um contorno para <a href="FAQ.htm#uac">problemas comuns relacionados ao UAC</a> ao permitir que o script automatize programas administrativos - sem que o script esteja executando como administrador. Para conseguir isso, o instalador faz o seguinte:</p>
<ul>
  <li>Copia os executáveis AutoHotkeyA32.exe, AutoHotkeyU32.exe e (se presente) AutoHotkeyU64.exe para AutoHotkey*_UIA.exe.</li>
  <li>Define o <a href="https://msdn.microsoft.com/en-us/library/ee671610">atributo uiAccess</a> no manifesto embutido em cada arquivo UIA.</li>
  <li>Cria um certificado digital autoassinado nomeado “AutoHotkey” e assina cada arquivo UIA.</li>
  <li>Registra a opção do menu contexto para executar o executável apropriado.</li>
</ul>
<p>Se quaisquer desses arquivos UIA estiverem presentes antes da instalação, o instalador irá automaticamente atualizá-los mesmo se a opção UI Access não estiver marcada.</p>
<p>Para instalações na linha de comando, especifique <code>/uiAccess</code> ou <code>/uiAccess=1</code> para habilitar a opção e <code>/uiAccess=0</code> para desabilitá-la. Por padrão, o instalador habilitará a opção se o UAC estiver habilitado e a opção UI Access do menu contexto estava presente antes da instalação.</p>
<p>Scripts que precisam executar outros scripts com acesso à IU podem simplesmente executar (<a href="lib/Run.htm">Run</a>) o arquivo UIA.exe apropriado com os <a href="#cmd">parâmetros da linha de comando</a> normais.</p>
<p><strong>Limitações conhecidas</strong>:</p>
<ul>
  <li>UIA só é eficaz se o arquivo estiver num local confiável; isto é, um subdiretório de “Arquivos de Programas”.</li>
  <li>Arquivos UIA.exe criados em um computador não podem executar em outros computadores sem antes instalar o certificado digital que foi usado para assiná-los.</li>
  <li>Arquivos UIA.exe não podem ser iniciados via CreateProcess devido a restrições de segurança. ShellExecute pode ser usado no lugar. <a href="lib/Run.htm">Run</a> tenta executar ambos.</li>
  <li>Arquivos UIA não podem ser modificados, uma vez que isso invalidaria a assinatura digital do arquivo.</li>
  <li>Tendo em vista que programas UIA executam em um “nível de integridade” diferente de outros programas, eles só podem acessar objetos registrados por outros programas UIA. Por exemplo, <code><a href="lib/ComObjActive.htm">ComObjActive</a>("Word.Application")</code> vai falhar porque o Microsoft Word não está marcado para acesso com IU.</li>
  <li>As janelas do próprio script não podem ser automatizadas por programas/scripts que não sejam UIA por motivos de segurança.</li>
  <li>Executar um script sem UIA que usa um gancho de mouse (mesmo se for tão simples quanto <code>#InstallMouseHook</code>) pode impedir o funcionamento de todas as hotkeys de mouse quando o mouse estiver apontando para uma janela pertencente a um script com UIA, mesmo hotkeys implementadas pelo próprio script UIA. Uma solução de contorno é certificar-se que scripts UIA sejam carregados por último.</li>
</ul>
<p>Para mais detalhes, veja <a href="https://www.autohotkey.com/board/topic/70449-enable-interaction-with-administrative-programs/">Habilitar interação com programas administrativos</a> no fórum arquivado.</p>

</body>
</html>
